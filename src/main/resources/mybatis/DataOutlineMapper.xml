<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jointsky.edps.mapper.DataOutlineMapper">


    <select id="getTotalDataRecordNum" resultType="int">
        SELECT SUM(TABLE_ROWS) from information_schema.tables WHERE TABLE_SCHEMA='crawldata';
    </select>

    <select id="getPSNum" resultType="int">
        SELECT COUNT(DISTINCT PSCode) from zxjcpscount;
    </select>

    <select id="getPSOutputNum" resultType="int">
        SELECT COUNT(DISTINCT pscode,outputcode) from zxjc_ps_outputcount;
    </select>

    <select id="getPwshfPSNum" resultType="int">
        SELECT COUNT(PSCode) from pwshfpscount;
    </select>



    <resultMap type="com.jointsky.edps.model.ProvinceCharge" id="ProvinceChargeMap">
        <result column="RegionName" property="regionName" />
        <result column="datamonth" property="dataMonth" />
        <result column="charge" property="charge" />
    </resultMap>

    <select id="getTop10ChargeProvince" resultMap="ProvinceChargeMap">
        SELECT regionname,datamonth,charge from pwshf_provincemonth_sum where datamonth=#{0} ORDER BY charge DESC LIMIT 0,10;
    </select>

    <resultMap type="com.jointsky.edps.model.ProvinceYearCharge" id="ProvinceYearChargeMap">
        <result column="regionname" property="regionName" />
        <result column="year" property="year" />
        <result column="charge" property="charge" />
    </resultMap>

    <select id="getYearTop10ChargeProvince" resultMap="ProvinceYearChargeMap">
        select regionname,substr(datamonth,1,4) year,sum(charge) charge from pwshf_provincemonth_sum where substr(datamonth,1,4)=#{0} GROUP BY regionname,substr(datamonth,1,4) ORDER BY sum(charge) desc LIMIT 0,10;
    </select>

</mapper>